<!DOCTYPE html>
<html lang="ja" data-theme="dark">
<!--begin::Head-->
<head>
  <title>Demonstration of msoffice2pdf</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!--begin::Fonts-->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,400,500,600,700" />
  <!--end::Fonts-->
  <!--begin::Global Stylesheets Bundle(used by all pages)-->
  <link href="theme/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
  <link href="theme/css/style.bundle.css" rel="stylesheet" type="text/css" />
  <!--end::Global Stylesheets Bundle-->

  <style>
    .dropzone.dropzone-queue .dropzone-item .dropzone-toolbar [class*="dropzone-"] i {
      transition: color 0.2s ease;
      font-size: 0.8rem;
      color: var(--kt-gray-800);
    }

    .dropzone.dropzone-queue .dropzone-item .dropzone-toolbar .dropzone-download,
    .dropzone.dropzone-queue .dropzone-item .dropzone-toolbar .dropzone-preview {
      height: 25px;
      width: 25px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: color 0.2s ease;
    }

    .badge {
      --bs-badge-font-weight: 400;
    }
  </style>
</head>
<!--end::Head-->
<!--begin::Body-->
<body>
  <!--begin::Content container-->
  <div class="container py-15 px-10">
  <!-- <div class="container-xxl py-15 px-10"> -->
    <!--begin::Heading-->
    <h1 class="mb-5">Office documents (ppt, pptx, doc, docx, xls, xlsx) to PDF.</h1>
    <!--end::Heading-->
    <!--begin::Form-->
    <form class="form" action="#" method="post">
      <!--begin::Dropzone-->
      <div data-ref="dropzone" class="dropzone dropzone-queue mb-2">
        <!--begin::Controls-->
        <div class="dropzone-panel mb-lg-0 mb-2 d-flex">
          <a data-ref="select" class="dropzone-select btn btn-sm btn-primary me-2">Select File</a>
          <a data-ref="convertAll" class="dropzone-upload btn btn-sm btn-light-primary me-2">Convert All</a>
          <a data-ref="removeAll" class="dropzone-remove-all btn btn-sm btn-light-primary">Remove All</a>
          <!--begin::Language-->
          <div class="d-flex align-items-center fw-bold ms-auto">
            <!--begin::Label-->
            <div class="text-gray-400 fs-7 me-2">Language</div>
            <!--end::Label-->
            <!--begin::Select-->
            <select
              data-ref="language"
              class="form-select form-select-transparent text-graY-800 fs-base lh-1 fw-bold py-0 ps-3 w-auto"
              data-control="select2"
              data-dropdown-css-class="w-150px">
              <option value="" selected="selected">No language</option>
              <option value="af">Afrikaans</option>
              <option value="sq">Albanian</option>
              <option value="ar-dz">Arabic (Algeria)</option>
              <option value="ar-bh">Arabic (Bahrain)</option>
              <option value="ar-eg">Arabic (Egypt)</option>
              <option value="ar-iq">Arabic (Iraq)</option>
              <option value="ar-jo">Arabic (Jordan)</option>
              <option value="ar-kw">Arabic (Kuwait)</option>
              <option value="ar-lb">Arabic (Lebanon)</option>
              <option value="ar-ly">Arabic (Libya)</option>
              <option value="ar-ma">Arabic (Morocco)</option>
              <option value="ar-om">Arabic (Oman)</option>
              <option value="ar-qa">Arabic (Qatar)</option>
              <option value="ar-sa">Arabic (Saudi Arabia)</option>
              <option value="ar-sy">Arabic (Syria)</option>
              <option value="ar-tn">Arabic (Tunisia)</option>
              <option value="ar-ae">Arabic (U.A.E.)</option>
              <option value="ar-ye">Arabic (Yemen)</option>
              <option value="eu">Basque</option>
              <option value="be">Belarusian</option>
              <option value="bg">Bulgarian</option>
              <option value="ca">Catalan</option>
              <option value="zh-hk">Chinese (Hong Kong)</option>
              <option value="zh-cn">Chinese (PRC)</option>
              <option value="zh-sg">Chinese (Singapore)</option>
              <option value="zh-tw">Chinese (Taiwan)</option>
              <option value="hr">Croatian</option>
              <option value="cs">Czech</option>
              <option value="da">Danish</option>
              <option value="nl-be">Dutch (Belgium)</option>
              <option value="nl">Dutch (Standard)</option>
              <option value="en">English</option>
              <option value="en-au">English (Australia)</option>
              <option value="en-bz">English (Belize)</option>
              <option value="en-ca">English (Canada)</option>
              <option value="en-ie">English (Ireland)</option>
              <option value="en-jm">English (Jamaica)</option>
              <option value="en-nz">English (New Zealand)</option>
              <option value="en-za">English (South Africa)</option>
              <option value="en-tt">English (Trinidad)</option>
              <option value="en-gb">English (United Kingdom)</option>
              <option value="en-us">English (United States)</option>
              <option value="et">Estonian</option>
              <option value="fo">Faeroese</option>
              <option value="fa">Farsi</option>
              <option value="fi">Finnish</option>
              <option value="fr-be">French (Belgium)</option>
              <option value="fr-ca">French (Canada)</option>
              <option value="fr-lu">French (Luxembourg)</option>
              <option value="fr">French (Standard)</option>
              <option value="fr-ch">French (Switzerland)</option>
              <option value="gd">Gaelic (Scotland)</option>
              <option value="de-at">German (Austria)</option>
              <option value="de-li">German (Liechtenstein)</option>
              <option value="de-lu">German (Luxembourg)</option>
              <option value="de">German (Standard)</option>
              <option value="de-ch">German (Switzerland)</option>
              <option value="el">Greek</option>
              <option value="he">Hebrew</option>
              <option value="hi">Hindi</option>
              <option value="hu">Hungarian</option>
              <option value="is">Icelandic</option>
              <option value="id">Indonesian</option>
              <option value="ga">Irish</option>
              <option value="it">Italian (Standard)</option>
              <option value="it-ch">Italian (Switzerland)</option>
              <option value="ja">Japanese</option>
              <option value="ko">Korean</option>
              <option value="ko">Korean (Johab)</option>
              <option value="ku">Kurdish</option>
              <option value="lv">Latvian</option>
              <option value="lt">Lithuanian</option>
              <option value="mk">Macedonian (FYROM)</option>
              <option value="ml">Malayalam</option>
              <option value="ms">Malaysian</option>
              <option value="mt">Maltese</option>
              <option value="no">Norwegian</option>
              <option value="nb">Norwegian (Bokmal)</option>
              <option value="nn">Norwegian (Nynorsk)</option>
              <option value="pl">Polish</option>
              <option value="pt-br">Portuguese (Brazil)</option>
              <option value="pt">Portuguese (Portugal)</option>
              <option value="pa">Punjabi</option>
              <option value="rm">Rhaeto-Romanic</option>
              <option value="ro">Romanian</option>
              <option value="ro-md">Romanian (Republic of Moldova)</option>
              <option value="ru">Russian</option>
              <option value="ru-md">Russian (Republic of Moldova)</option>
              <option value="sr">Serbian</option>
              <option value="sk">Slovak</option>
              <option value="sl">Slovenian</option>
              <option value="sb">Sorbian</option>
              <option value="es-ar">Spanish (Argentina)</option>
              <option value="es-bo">Spanish (Bolivia)</option>
              <option value="es-cl">Spanish (Chile)</option>
              <option value="es-co">Spanish (Colombia)</option>
              <option value="es-cr">Spanish (Costa Rica)</option>
              <option value="es-do">Spanish (Dominican Republic)</option>
              <option value="es-ec">Spanish (Ecuador)</option>
              <option value="es-sv">Spanish (El Salvador)</option>
              <option value="es-gt">Spanish (Guatemala)</option>
              <option value="es-hn">Spanish (Honduras)</option>
              <option value="es-mx">Spanish (Mexico)</option>
              <option value="es-ni">Spanish (Nicaragua)</option>
              <option value="es-pa">Spanish (Panama)</option>
              <option value="es-py">Spanish (Paraguay)</option>
              <option value="es-pe">Spanish (Peru)</option>
              <option value="es-pr">Spanish (Puerto Rico)</option>
              <option value="es">Spanish (Spain)</option>
              <option value="es-uy">Spanish (Uruguay)</option>
              <option value="es-ve">Spanish (Venezuela)</option>
              <option value="sv">Swedish</option>
              <option value="sv-fi">Swedish (Finland)</option>
              <option value="th">Thai</option>
              <option value="ts">Tsonga</option>
              <option value="tn">Tswana</option>
              <option value="tr">Turkish</option>
              <option value="ua">Ukrainian</option>
              <option value="ur">Urdu</option>
              <option value="ve">Venda</option>
              <option value="vi">Vietnamese</option>
              <option value="cy">Welsh</option>
              <option value="xh">Xhosa</option>
              <option value="ji">Yiddish</option>
              <option value="zu">Zulu</option>
            </select>
            <!--end::Select-->
          </div>
          <!--end::Language-->
        </div>
        <!--end::Controls-->
        <!--begin::Items-->
        <div data-ref="dropzoneItems"></div>
        <!--end::Items-->
      </div>
      <!--end::Dropzone-->
    </form>
    <!--end::Form-->
  </div>
  <!--end::Content container-->
  <!--begin::Javascript-->
  <!--begin::Global Javascript Bundle(used by all pages)-->
  <script src="theme/plugins/global/plugins.bundle.js"></script>
  <script src="theme/js/scripts.bundle.js"></script>
  <!--end::Global Javascript Bundle-->
	<!--begin::Custom Javascript(used for this page only)-->
  <script src="libs/metronic-extension/dist/build.js"></script>
  <script>
    const {selectRef, initTooltip} = metronicExtension;
    const ref = selectRef();

    // Make the whole body a dropzone.
    const dropzone = new Dropzone(ref.dropzone.get(0), {
      // Set the url for your upload script location.
      url: '/convert',
      paramName: 'files',
      parallelUploads: 20,
      acceptedFiles: [
        'application/vnd.ms-excel',
        'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
        'application/msword',
        'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
        'application/vnd.ms-powerpoint',
        'application/vnd.openxmlformats-officedocument.presentationml.presentation',
      ].join(','),
      previewTemplate: 
        `<div class="dropzone-item">
          <!--begin::Svg Icon | path: icons/duotune/files/fil003.svg-->
          <span class="svg-icon svg-icon-2x svg-icon-primary me-4">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path opacity="0.3" d="M19 22H5C4.4 22 4 21.6 4 21V3C4 2.4 4.4 2 5 2H14L20 8V21C20 21.6 19.6 22 19 22Z" fill="currentColor"></path>
              <path d="M15 8H20L14 2V7C14 7.6 14.4 8 15 8Z" fill="currentColor"></path>
            </svg>
          </span>
          <!--end::Svg Icon-->
          <!--begin::File-->
          <div class="dropzone-file">
            <div class="dropzone-filename text-gray-800" style="cursor: default;">
            <!-- <div class="dropzone-filename"> -->
              <span data-dz-name></span>
              <strong>(<span data-dz-size>0kb</span>)</strong>
            </div>
            <div class="dropzone-error" data-dz-errormessage></div>
          </div>
          <!--end::File-->
          <!--begin::Progress-->
          <div class="dropzone-progress">
            <div class="progress">
              <div class="progress-bar bg-primary" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" data-dz-uploadprogress></div>
            </div>
          </div>
          <!--end::Progress-->
          <!--begin::Status-->
          <div class="dropzone-status text-gray-800 fs-8 ms-4 d-none">
            <span class="badge badge-secondary text-uppercase me-2">uploading</span>
          </div>
          <!--end::Status-->
          <!--begin::Toolbar-->
          <div class="dropzone-toolbar">
            <span
              class="dropzone-start"
              data-bs-toggle="tooltip"
              title="Click me to convert file.">
              <i class="bi bi-play-fill fs-3"></i></span>
            <a
              class="dropzone-download d-none"
              data-bs-toggle="tooltip"
              title="Click me to download file."
              download>
              <i class="bi bi-download fs-3"></i></a>
            <a
              class="dropzone-preview d-none"
              data-bs-toggle="tooltip"
              title="Click me to preview file."
              target="_blank">
              <i class="bi bi-search fs-5"></i></a>
            <span
              class="dropzone-cancel"
              data-dz-remove
              data-bs-toggle="tooltip"
              title="Click me to remove file."
              style="display: none;">
              <i class="bi bi-x fs-3"></i></span>
            <span
              class="dropzone-delete"
              data-dz-remove
              data-bs-toggle="tooltip"
              title="Click me to remove file.">
              <i class="bi bi-x fs-1"></i></span>
          </div>
          <!--end::Toolbar-->
        </div>`,
      // Max filesize in MB.
      maxFilesize: 100,
      // Make sure the files aren't queued until manually added.
      autoQueue: false,
      // Define the container to display the previews.
      previewsContainer: ref.dropzoneItems.get(0),
      // Define the element that should be used as click trigger to select files.
      clickable: ref.select.get(0)
    });

    dropzone.on('addedfile', file => {
      const dropzoneItem = $(file.previewElement)

      // Hookup the start button.
      dropzoneItem.on('click', '.dropzone-start', () => dropzone.enqueueFile(file));

      // Hide the Upload and Delete buttons for all files.
      ref.convertAll.css('display', 'inline-block');
      ref.removeAll.css('display', 'inline-block');

      // Display tooltips on the buttons of the added items.
      initTooltip(dropzoneItem);
    });

    // Update the progress bar.
    dropzone.on('uploadprogress', (file, progress) => {
      const dropzoneItem = $(file.previewElement);
      dropzoneItem
        .find('.progress-bar')
        .css('width', `${progress}%`);
      
      // Displays the status during processing.
      if (progress === 100)
        dropzoneItem.find('.dropzone-status').html('<span class="badge badge-secondary text-uppercase">processing</span>');
    });
    // dropzone.on('totaluploadprogress', progress => {
    //   ref.dropzone
    //     .find('.progress-bar')
    //     .css('width', `${progress}%`);
    // });
    dropzone.on('sending', (file, xhr, formData) => {
      const dropzoneItem = $(file.previewElement);
      // Show the total progress bar when upload starts.
      dropzoneItem.find('.progress-bar').css('opacity', 1);

      // And disable the start button
      dropzoneItem.find('.dropzone-start').prop('disabled', true);

      // Displays the status of the upload in progress.
      dropzoneItem.find('.dropzone-status').removeClass('d-none');

      // Add language options to the data to be sent.
      formData.append('language', ref.language.val());
    });

    // Hide the progress bar when nothing's uploading anymore.
    dropzone.on('complete', file => {
      const dropzoneItem = ref.dropzone.find('.dz-complete');
      setTimeout(() => {
        dropzoneItem.find('.progress-bar').css('opacity', 0);
        dropzoneItem.find('.progress').css('opacity', 0);
        dropzoneItem.find('.dropzone-start').addClass('d-none');
        if (file.status !== 'error') {
          dropzoneItem.find('.dropzone-download').removeClass('d-none');
          dropzoneItem.find('.dropzone-preview').removeClass('d-none');
          dropzoneItem.find('.dropzone-status').html('<span class="badge badge-success text-uppercase">finished</span>');
        } else
          dropzoneItem.find('.dropzone-status')
            .html('<span class="badge badge-danger text-uppercase">error</span>')
            .removeClass('d-none');
      }, 300);
    });

    // On all files completed upload
    dropzone.on('queuecomplete', () => {
      ref.convertAll.css('display', 'none');
    });

    // On all files removed
    dropzone.on('removedfile', file => {
      if (dropzone.files.length < 1) {
        ref.convertAll.css('display', 'none');
        ref.removeAll.css('display', 'none');
      }
    });

    // Response after upload success.
    dropzone.on('success', (file, res) => {
      // Create a download link for the converted PDF file.
      const dropzoneItem = $(file.previewElement);
      dropzoneItem.find('.dropzone-download').attr('href', res.filePath);
      dropzoneItem.find('.dropzone-preview').attr('href', res.filePath);
    });

    // Delete the tooltip at the same time the file is deleted.
    dropzone.on('removedfile', file => {
      for (let tooltipTrigger of file.previewElement.querySelectorAll('.dropzone-start,.dropzone-download,.dropzone-preview,.dropzone-cancel,.dropzone-delete')) {
        const tooltip = bootstrap.Tooltip.getInstance(tooltipTrigger);
        tooltip.dispose();
      }
    });

    // Setup the buttons for all transfers
    ref.convertAll.on('click', () => {
      dropzone.enqueueFiles(dropzone.getFilesWithStatus(Dropzone.ADDED));
    });

    // Setup the button for remove all files
    ref.removeAll.on('click', () => {
      ref.convertAll.css('display', 'none');
      ref.removeAll.css('display', 'none');
      dropzone.removeAllFiles(true);
    });
  </script>
  <!--end::Custom Javascript-->
  <!--end::Javascript-->
</body>
<!--end::Body-->
</html>